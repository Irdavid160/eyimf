<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Daily Devotions • EYIMF</title>
  <link rel="icon" href="assets/favicon.png">
 <link rel="stylesheet" href="style.css?v=devotions2">
</head>
<body class="devotion-page">
  <nav>
    <div class="container navbar">
      <div class="brand"><span class="name">Examine Yourselves International Mission Foundation</span></div>
      <div class="navlinks">
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="whatwedo.html">What We Do</a>
        <a href="updates.html">Updates</a>
        <a href="media.html">Media</a>
        <a href="contact.html" class="cta">Contact</a>
      </div>
    </div>
  </nav>

  <section class="section">
    <div class="container">
      <h1 style="text-align:center;margin-bottom:8px;">Daily Devotion</h1>
      <div id="devotion" class="devotion-container">
        <p class="no-devotion">Loading today's devotion...</p>
      </div>
      <p style="text-align:center;margin-top:10px;">
        <a class="text-link" href="updates.html">← Back to Updates</a>
      </p>
    </div>
  </section>

  <footer class="footer" id="contact">
    <div class="container">
      <div style="display:flex;justify-content:space-between;gap:20px;flex-wrap:wrap;">
        <div><strong>Examine Yourselves International Mission Foundation</strong><br>
          Email: <a href="mailto:info@eyimf.org">info@eyimf.org</a></div>
        <div><div>“Serving souls, meeting needs, glorifying Christ.”</div>
          <div style="margin-top:8px;">KJV — James 2:15–17</div></div>
      </div>
      <div style="margin-top:16px;opacity:.8">© <span id="yr"></span> EYIMF</div>
    </div>
    <script>document.getElementById('yr').textContent=new Date().getFullYear()</script>
  </footer>

  <script>
    // minimal: shows today's devotion (with fallback)
    const JSON_URL = 'assets/devotions/devotions.json?v=1';
    const pad = n => String(n).padStart(2,'0');
    const todayISO = (() => {
      const d = new Date();
      return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
    })();

    fetch(JSON_URL, {cache:'no-store'})
      .then(r => r.json())
      .then(devs => {
        const d = devs.find(x => x.date === todayISO) || devs[(new Date().getDate()-1) % devs.length];
        const el = document.getElementById('devotion');
        if (!d) { el.innerHTML = '<p class="no-devotion">No devotion posted for today.</p>'; return; }
       const body = (d.body || '')
  .replace(/\\n/g, '<br>')        // turn \n into line breaks
  .split(/<br>\s*<br>/)           // split on double breaks for paragraphs
  .map(p => `<p>${p.trim()}</p>`) // wrap each paragraph
  .join('');
        el.innerHTML = `
          <h2>${d.title||'Devotion'}</h2>
          <div class="scripture">${d.scripture||''}</div>
          ${body}
        `;
        el.classList.add('loaded'); // if you added the fade-in CSS
      })
      .catch(() => {
        document.getElementById('devotion').innerHTML =
          '<p class="no-devotion">Unable to load today’s devotion.</p>';
      });
  </script>
</body>
</html>
